(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e,t,a){e.exports=a(59)},34:function(e,t,a){},59:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),r=a(4),i=a.n(r),l=a(8),c=a(3),s=a(22),u=a(7),p=a(25),d=a(18),m=(a(34),a(35),function(e){var t=Object(o.useState)(null),a=Object(c.a)(t,2),n=a[0],r=a[1],i=Object(o.useState)(!0),l=Object(c.a)(i,2),s=l[0],u=l[1],p=Object(o.useState)(null),d=Object(c.a)(p,2),m=d[0],g=d[1];return Object(o.useEffect)(function(){var t=new AbortController;return fetch(e,{signal:t.signal}).then(function(e){if(!e.ok)throw Error("could not fetch the data for that resources");return e.json()}).then(function(e){console.log(e),r(e),u(!1),g(null)}).catch(function(e){console.log("fetch error",e),"AbortError"===e.name?console.log("fetch aborted"):(u(!1),g(e.message))}),function(){return t.abort()}},[e]),{data:n,isPending:s,error:m}}),g=a(14);function b(){var e=Object(o.useState)({latitude:12.4578,longitude:16.55445,zoom:1.5}),t=Object(c.a)(e,2),a=t[0],r=t[1],i={width:"20px",height:"20px",color:"#fff",background:"#00f",borderRadius:"20px",textAlign:"center"},b=[],h="http://gmv/api/taxonomy_term/cateegorie_partenaire";console.log("urlpartner",h);var f=m(h),j=f.data;f.isPending,f.error;console.log("partners:",j),j&&j.data.map(function(e){return b.push({value:e.attributes.drupal_internal__tid,label:e.attributes.name})});var E=Object(o.useState)(""),v=Object(c.a)(E,2),y=v[0],O=(v[1],Object(o.useState)("")),_=Object(c.a)(O,2),w=_[0],N=_[1],S="http://gmv/geolocations/?_format=json",x=Object(o.useState)(S),k=Object(c.a)(x,2),J=k[0],C=k[1],I=function(e){var t=S+"&field_categorie_target_id="+e.value;C(t),N(e),console.log("new url",t)},z=[],F=[],P=Object(o.useState)([]),W=Object(c.a)(P,2),A=W[0],D=W[1];return Object(o.useEffect)(function(){fetch(J).then(function(e){return e.json()}).then(function(e){console.log("new url for looping",J),e.slice(0,2e3).forEach(function(e){e.projet_id&&!F.includes(e.projet_id)&&(z.push({id:e.projet_id,title:e.projet_title,type:"projet",properties:{cluster:!1,glocationId:e.projet_id},geometry:{coordinates:[parseFloat(JSON.parse(e.projet_localisation).coordinates[1]),parseFloat(JSON.parse(e.projet_localisation).coordinates[0])]}}),F.push(e.projet_id)),e.partenaire_id&&!F.includes(e.partenaire_id)&&(z.push({id:e.partenaire_id,title:e.partenaire_title,type:"partenaire",properties:{cluster:!1,glocationId:e.partenaire_id},geometry:{coordinates:[parseFloat(JSON.parse(e.partenaire_localisation).coordinates[1]),parseFloat(JSON.parse(e.partenaire_localisation).coordinates[0])]}}),F.push(e.partenaire_id))}),D(z),console.log("gLocations.length",z)}).catch(function(e){})},[J]),n.a.createElement("div",{className:"carto"},n.a.createElement("div",{className:"row filtering"},n.a.createElement("div",{className:"col-md-3"},n.a.createElement("label",null,"Par cat\xe9gorie"),n.a.createElement(g.a,{options:b,value:w,onChange:I})),n.a.createElement("div",{className:"col-md-3"},n.a.createElement("label",null,"Par th\xe9matique"),n.a.createElement(g.a,{options:b,value:w,onChange:I})),n.a.createElement("div",{className:"col-md-3"},n.a.createElement("label",null,"Par type de r\xe9alisation"),n.a.createElement(g.a,{options:b,value:w,onChange:I})),n.a.createElement("div",{className:"col-md-3"},n.a.createElement("input",{type:"search",value:y,className:"input",placeholder:""})),n.a.createElement("div",{className:"col-md-3"},n.a.createElement("input",{type:"submit",value:"Chercher",onSubmit:function(){Object(s.a)("url"),alert(J),console.log("new url",J),C(J)}}))),n.a.createElement("div",{className:"row the_mapbox"},n.a.createElement(u.c,Object.assign({style:{width:"100%",height:"400px",marginTop:"15px"},mapStyle:"mapbox://styles/mapbox/light-v9",accessToken:"pk.eyJ1IjoibW1zb3ciLCJhIjoiY2t0YmFydjB1MXR5NDJ1cWxxZWhjZnYwciJ9.CZER0uLmoE91iAgIptvD3g",onViewportChange:function(e){r(Object(l.a)({},e))}},a),n.a.createElement(p.a,{radius:80,extent:512,nodeSize:64,component:function(e){var t=e.longitude,a=e.latitude,o=e.pointCount;return n.a.createElement(u.b,{longitude:t,latitude:a},n.a.createElement("div",{style:Object(l.a)({},i,{background:"orange"})},o))}},A.map(function(e){return"partenaire"==e.type?n.a.createElement(u.b,{key:e.id,longitude:e.geometry.coordinates[1],latitude:e.geometry.coordinates[0]},n.a.createElement("button",{className:e.type},n.a.createElement(d.a,{color:"#aaD100",size:"2em",title:e.title}))):"projet"==e.type?n.a.createElement(u.b,{key:e.id,longitude:e.geometry.coordinates[1],latitude:e.geometry.coordinates[0]},n.a.createElement("button",{style:{outline:"none !important;"},className:e.type},n.a.createElement(d.b,{color:"#00D100",size:"1.6em",title:e.title}))):void 0})))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(b,null),document.getElementById("mapcarto")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[27,1,2]]]);
//# sourceMappingURL=main.3253d4b5.chunk.js.map